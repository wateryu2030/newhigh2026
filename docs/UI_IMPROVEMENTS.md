# UI 优化说明

## 问题

左右侧都有策略选择功能，容易引起歧义：
- 左侧：策略列表（可点击选择）
- 右侧：策略下拉框（也可选择）

## 解决方案

### 1. 移除右侧下拉框

- **之前**：右侧有策略下拉框 `<select id="strategyFile">`
- **现在**：改为只读输入框，显示"已选策略"，提示"请在左侧列表中选择策略"
- **效果**：策略选择统一在左侧列表，右侧仅显示已选策略

### 2. 优化交互

- 点击左侧策略列表项时：
  - 高亮显示（绿色边框）
  - 自动设置到右侧"已选策略"输入框
  - 格式：`策略名称 (文件名.py)`
  - 同时保存文件名到 `data-file` 属性

### 3. 回测时获取策略

- JavaScript 从 `data-file` 属性获取实际文件名
- 如果没有，则从显示文本中解析文件名
- 确保回测使用正确的策略文件

## 自动补齐数据文件

### 功能

在运行回测前，自动检查策略所需的数据文件：
- 如果文件不存在或文件太小（<50字节），自动生成
- 如果用户选择了股票，确保该股票在策略的股票池中

### 支持的策略

1. **行业轮动策略** (`strategy1_industry_rotation.py`)
   - `data/industry_stock_map.csv`
   - `data/industry_score.csv`

2. **动量+均值回归混合** (`strategy2_momentum_meanreversion.py`)
   - `data/tech_leader_stocks.csv`
   - `data/consume_leader_stocks.csv`
   - 自动将用户选择的股票添加到对应股票池

3. **财报超预期事件驱动** (`strategy3_earnings_surprise.py`)
   - `data/earnings_events.csv`

4. **ETF网格交易** (`strategy4_etf_grid.py`)
   - `data/etf_list.csv`

### 使用方式

无需手动操作，回测时自动执行：
1. 选择策略和股票
2. 点击"运行回测"
3. 系统自动检查并补齐所需数据文件
4. 如果文件缺失，会在日志中显示"✅ 已自动补齐策略所需数据文件"

## 测试建议

1. **测试UI优化**：
   - 点击左侧策略列表，确认右侧"已选策略"正确显示
   - 确认不再有重复的策略选择控件

2. **测试自动补齐**：
   - 删除某个策略的数据文件（如 `data/tech_leader_stocks.csv`）
   - 选择对应策略运行回测
   - 确认文件自动生成

3. **测试股票池自动添加**：
   - 选择策略2（动量+均值回归）
   - 选择不在股票池中的股票（如 002701）
   - 运行回测，确认股票自动添加到股票池
